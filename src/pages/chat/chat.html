
<ion-header>
    <ion-navbar>
        <button color="primary" ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title class="title" *ngIf="user">
            <img [src]="user.photoURL">
            {{ user.firstName }}
        </ion-title>
        <ion-buttons end>
            <button ion-button (click)="showOptions()">
                <img height="25" src="assets/dots.png"/>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>

<ion-content>
    <ion-segment class="segment" [(ngModel)]="viewState" color="primary">
        <ion-segment-button value="messages" (click)="changeState('messages')">
            Messages
        </ion-segment-button>
        <ion-segment-button value="about" (click)="changeState('about')">
            About
        </ion-segment-button>
    </ion-segment>
    <div class="chat-area" [ngClass]="{'hidden': viewState == 'about' }">
        <h5 id="messages-text" *ngIf="!messages">Say Hi to start the conversation.</h5>
        <ion-list no-lines [virtualScroll]="messages" approxItemWidth="200px" approxItemHeight="200px">
            <ion-item *virtualItem="let message">
                <div *ngIf="message.message" class="chat-bubble {{ message.position }} ">
                    <div class="message">{{ message.message }}</div>
                </div>
                <div *ngIf="message.url" class="img-bubble {{ message.position }}">
                    <ion-img [src]="message.url" width="200" height="200"></ion-img>
                    <div class="spinner">
                        <ion-spinner color="primary" name="dots"></ion-spinner>
                    </div>
                </div>
            </ion-item>
        </ion-list>
    </div>
    <div class="about" *ngIf="viewState == 'about'">
        <div class="content">
            <img [src]="user.photoURL">
            <h5 *ngIf="!user.bio">{{ user.firstName }} does not have a bio.</h5>
            <h5 *ngIf="user.bio">{{ user.bio }}</h5>
            <p>Tap the options button above to view {{ user.firstName }}'s profile.</p>
        </div>
    </div>
</ion-content>
<ion-footer class="chat-footer">
    <form (ngSubmit)="send()" name="chat-form">
        <button class="attach" (click)="presentActionSheet()">
            <img src="assets/attach.png">
        </button>
        <div class="message">
            <ion-textarea type="text" name="chat-message" [(ngModel)]="chatInput" placeholder="Type a Message" spellcheck="true"></ion-textarea>
        </div>
        <button class="send" ion-button type="submit">
            <img src="assets/send.png">
        </button>
    </form>
</ion-footer>